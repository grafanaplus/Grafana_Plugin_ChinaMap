{"version":3,"sources":["../src/map_renderer.js"],"names":["link","scope","elem","attrs","ctrl","mapContainer","find","events","on","render","renderingCompleted","data","map","echarts","init","thresholds","forEach","dataPoint","key","mapValue","天津","valueFormatted","辽宁","山东","panel","split","strValue","Number","trim","option","backgroundColor","tooltip","trigger","formatter","visualMap","min","max","left","inRange","color","dataColors","textStyle","thresholdTextColor","top","text","calculable","series","name","type","mapType","selectedMode","label","normal","show","labelColor","emphasis","labelEmphasisColor","itemStyle","areaColor","itemNormalColor","borderColor","itemBorderColor","itemEmphasisColor","value","setOption","opts","width","height","silent","resize"],"mappings":"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","file":"map_renderer.js","sourcesContent":["import echarts from './lib/echarts.min';\r\n\r\nexport default function link(scope, elem, attrs, ctrl) {\r\n  const mapContainer = elem.find('.chinamap-panel');\r\n\r\n  ctrl.events.on('render', () => {\r\n    render();\r\n    ctrl.renderingCompleted();\r\n  });\r\n\r\n  function render() {\r\n    if (!ctrl.data) return;\r\n\r\n    if (!ctrl.map) {\r\n      ctrl.map = echarts.init(mapContainer[0]);\r\n\t  \r\n    }\r\n\t\r\n\tconst data = ctrl.data;\r\n\t//var value1;\r\n\t//var value2;\r\n\t//var value3;\r\n\r\n\t\r\n\r\n\tvar thresholds;\r\n\t\r\n\tdata.forEach((dataPoint) => {\r\n      \r\n\t  if(dataPoint.key == '天津')  ctrl.mapValue.天津=dataPoint.valueFormatted;\r\n\t  if(dataPoint.key == '辽宁')  ctrl.mapValue.辽宁=dataPoint.valueFormatted;\r\n\t  if(dataPoint.key == '山东')  ctrl.mapValue.山东=dataPoint.valueFormatted;\r\n\t\r\n\t  \r\n    });\r\n\t\r\n\tthresholds = ctrl.panel.thresholds.split(',').map((strValue) => {\r\n\treturn Number(strValue.trim());\r\n\t });\r\n\t\r\n\tvar option = {\r\n\t\t\tbackgroundColor: ctrl.panel.backgroundColor,\r\n\t\t\ttooltip: {\r\n\t\t\t\ttrigger: 'item',\r\n\t\t\t\tformatter: '{b} {c}'\r\n\t\t\t},\r\n\t\t\tvisualMap: {\r\n\t\t\t\tmin: thresholds[0],\r\n\t\t\t\tmax: thresholds[1],\r\n\t\t\t\tleft: 'left',\r\n\t\t\t\tinRange: {\r\n\t\t\t\t\tcolor: ctrl.panel.dataColors\r\n\t\t\t\t},\r\n\t\t\t\ttextStyle: {\r\n\t\t\t\t\tcolor:ctrl.panel.thresholdTextColor\r\n\t\t\t},\r\n\t\t\ttop: 'bottom',\r\n\t\t\ttext: ['高','低'],           // 文本，默认为数值文本\r\n\t\t\tcalculable: true\r\n\t\t\t},\r\n\t\t\tseries: [\r\n\t\t\t\t{\r\n\t\t\t\t\tname: '中国',\r\n\t\t\t\t\ttype: 'map',\r\n\t\t\t\t\tmapType: 'china',\r\n\t\t\t\t\tselectedMode : 'multiple',\r\n\t\t\t\t\tlabel: {\r\n\t\t\t\t\t\tnormal: {\r\n\t\t\t\t\t\t\tshow: true,\r\n\t\t\t\t\t\t\ttextStyle: {\r\n\t\t\t\t\t\t\t\tcolor: ctrl.panel.labelColor\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\temphasis: {\r\n\t\t\t\t\t\t\tshow: true,\r\n\t\t\t\t\t\t\ttextStyle: {\r\n\t\t\t\t\t\t\t\tcolor: ctrl.panel.labelEmphasisColor\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\titemStyle: {\r\n\t\t\t\t\t\tnormal: {\r\n\t\t\t\t\t\t\tareaColor: ctrl.panel.itemNormalColor,\r\n\t\t\t\t\t\t\tborderColor: ctrl.panel.itemBorderColor\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\temphasis: {\r\n\t\t\t\t\t\t\tareaColor: ctrl.panel.itemEmphasisColor\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\t\t\r\n\t\t\t\t\tdata:[\r\n\t\t\t\t\t\t{name:'天津', value: ctrl.mapValue.天津},\r\n\t\t\t\t\t\t{name:'辽宁', value: ctrl.mapValue.辽宁},\r\n\t\t\t\t\t\t{name:'山东', value: ctrl.mapValue.山东},\r\n\t\t\t\t\t]\r\n\t\t\t\t}\r\n\t\t\t]\r\n\t\t};\r\n    // 使用刚指定的配置项和数据显示图表。\r\n    ctrl.map.setOption(option);\r\n\t\r\n\tvar opts = {\r\n\t\t\r\n\t\twidth:'auto',\r\n\t\theight: ctrl.height,\r\n\t\tsilent: false\r\n\t}\r\n\t\r\n    ctrl.map.resize(opts);\r\n\t\t\r\n\r\n\t/*\r\n    if (ctrl.mapCenterMoved) ctrl.map.panToMapCenter();\r\n\r\n    if (!ctrl.map.legend && ctrl.panel.showLegend) ctrl.map.createLegend();\r\n\r\n    ctrl.map.drawCircles();\r\n\t*/\r\n\t\r\n  }\r\n}"]}