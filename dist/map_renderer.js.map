{"version":3,"sources":["../src/map_renderer.js"],"names":["link","scope","elem","attrs","ctrl","mapContainer","find","events","on","render","renderingCompleted","data","map","echarts","init","value1","value2","thresholds","forEach","dataPoint","key","valueFormatted","panel","split","strValue","Number","trim","option","backgroundColor","tooltip","trigger","formatter","visualMap","min","max","left","inRange","color","dataColors","textStyle","thresholdTextColor","top","text","calculable","series","name","type","mapType","selectedMode","label","normal","show","labelColor","emphasis","labelEmphasisColor","itemStyle","areaColor","itemNormalColor","borderColor","itemBorderColor","itemEmphasisColor","value","setOption","console","log","height","resize"],"mappings":";;;;;;AAEe,UAASA,IAAT,CAAcC,KAAd,EAAqBC,IAArB,EAA2BC,KAA3B,EAAkCC,IAAlC,EAAwC;AACrD,MAAMC,eAAeH,KAAKI,IAAL,CAAU,iBAAV,CAArB;;AAEAF,OAAKG,MAAL,CAAYC,EAAZ,CAAe,QAAf,EAAyB,YAAM;AAC7BC;AACAL,QAAKM,kBAAL;AACD,GAHD;;AAKA,WAASD,MAAT,GAAkB;AAChB,OAAI,CAACL,KAAKO,IAAV,EAAgB;;AAEhB,OAAI,CAACP,KAAKQ,GAAV,EAAe;AACbR,SAAKQ,GAAL,GAAWC,QAAQC,IAAR,CAAaT,aAAa,CAAb,CAAb,CAAX;AAED;;AAEJ,OAAMM,OAAOP,KAAKO,IAAlB;AACA,OAAII,MAAJ;AACA,OAAIC,MAAJ;AACA,OAAIC,UAAJ;;AAEAN,QAAKO,OAAL,CAAa,UAACC,SAAD,EAAe;;AAE1B,QAAGA,UAAUC,GAAV,IAAiB,QAApB,EAA+BL,SAAOI,UAAUE,cAAjB;AAC/B,QAAGF,UAAUC,GAAV,IAAiB,WAApB,EAAkCJ,SAAOG,UAAUE,cAAjB;AAEhC,IALJ;;AAOAJ,gBAAab,KAAKkB,KAAL,CAAWL,UAAX,CAAsBM,KAAtB,CAA4B,GAA5B,EAAiCX,GAAjC,CAAqC,UAACY,QAAD,EAAc;AAChE,WAAOC,OAAOD,SAASE,IAAT,EAAP,CAAP;AACE,IAFW,CAAb;;AAIA,OAAIC,SAAS;AACXC,qBAAiBxB,KAAKkB,KAAL,CAAWM,eADjB;AAEXC,aAAS;AACRC,cAAS,MADD;AAERC,gBAAW;AAFH,KAFE;AAMXC,eAAW;AACVC,UAAKhB,WAAW,CAAX,CADK;AAEViB,UAAKjB,WAAW,CAAX,CAFK;AAGVkB,WAAM,MAHI;AAIVC,cAAS;AACRC,aAAOjC,KAAKkB,KAAL,CAAWgB;AADV,MAJC;AAOVC,gBAAW;AACVF,aAAMjC,KAAKkB,KAAL,CAAWkB;AADP,MAPD;AAUXC,UAAK,QAVM;AAWXC,WAAM,CAAC,GAAD,EAAK,GAAL,CAXK,EAWgB;AAC3BC,iBAAY;AAZD,KANA;AAoBXC,YAAQ,CACP;AACCC,WAAM,IADP;AAECC,WAAM,KAFP;AAGCC,cAAS,OAHV;AAICC,mBAAe,UAJhB;AAKCC,YAAO;AACNC,cAAQ;AACPC,aAAM,IADC;AAEPZ,kBAAW;AACVF,eAAOjC,KAAKkB,KAAL,CAAW8B;AADR;AAFJ,OADF;AAONC,gBAAU;AACTF,aAAM,IADG;AAETZ,kBAAW;AACVF,eAAOjC,KAAKkB,KAAL,CAAWgC;AADR;AAFF;AAPJ,MALR;AAmBCC,gBAAW;AACVL,cAAQ;AACPM,kBAAWpD,KAAKkB,KAAL,CAAWmC,eADf;AAEPC,oBAAatD,KAAKkB,KAAL,CAAWqC;AAFjB,OADE;AAKVN,gBAAU;AACTG,kBAAWpD,KAAKkB,KAAL,CAAWsC;AADb;AALA,MAnBZ;AA4BCjD,WAAK,CACJ,EAACkC,MAAK,IAAN,EAAYgB,OAAO9C,MAAnB,EADI,EAEJ,EAAC8B,MAAK,IAAN,EAAYgB,OAAO7C,MAAnB,EAFI;AA5BN,KADO;AApBG,IAAb;AAwDG;AACAZ,QAAKQ,GAAL,CAASkD,SAAT,CAAmBnC,MAAnB;;AAEHoC,WAAQC,GAAR,CAAY,mBAAmB5D,KAAK6D,MAApC;AACG7D,QAAKQ,GAAL,CAASsD,MAAT,CAAgB,MAAhB,EAAuB9D,KAAK6D,MAA5B;;AAGH;;;;;;;AAQE;AACF;;oBAxGuBjE,I;;;;AAFjBa,U","file":"map_renderer.js","sourcesContent":["import echarts from './lib/echarts.min';\r\n\r\nexport default function link(scope, elem, attrs, ctrl) {\r\n  const mapContainer = elem.find('.chinamap-panel');\r\n\r\n  ctrl.events.on('render', () => {\r\n    render();\r\n    ctrl.renderingCompleted();\r\n  });\r\n\r\n  function render() {\r\n    if (!ctrl.data) return;\r\n\r\n    if (!ctrl.map) {\r\n      ctrl.map = echarts.init(mapContainer[0]);\r\n\t  \r\n    }\r\n\t\r\n\tconst data = ctrl.data;\r\n\tvar value1;\r\n\tvar value2;\r\n\tvar thresholds;\r\n\t\r\n\tdata.forEach((dataPoint) => {\r\n      \r\n\t  if(dataPoint.key == 'sydney')  value1=dataPoint.valueFormatted;\r\n\t  if(dataPoint.key == 'singapore')  value2=dataPoint.valueFormatted;\r\n\t  \r\n    });\r\n\t\r\n\tthresholds = ctrl.panel.thresholds.split(',').map((strValue) => {\r\n\treturn Number(strValue.trim());\r\n\t });\r\n\t\r\n\tvar option = {\r\n\t\t\tbackgroundColor: ctrl.panel.backgroundColor,\r\n\t\t\ttooltip: {\r\n\t\t\t\ttrigger: 'item',\r\n\t\t\t\tformatter: '{b}'\r\n\t\t\t},\r\n\t\t\tvisualMap: {\r\n\t\t\t\tmin: thresholds[0],\r\n\t\t\t\tmax: thresholds[1],\r\n\t\t\t\tleft: 'left',\r\n\t\t\t\tinRange: {\r\n\t\t\t\t\tcolor: ctrl.panel.dataColors\r\n\t\t\t\t},\r\n\t\t\t\ttextStyle: {\r\n\t\t\t\t\tcolor:ctrl.panel.thresholdTextColor\r\n\t\t\t},\r\n\t\t\ttop: 'bottom',\r\n\t\t\ttext: ['高','低'],           // 文本，默认为数值文本\r\n\t\t\tcalculable: true\r\n\t\t\t},\r\n\t\t\tseries: [\r\n\t\t\t\t{\r\n\t\t\t\t\tname: '中国',\r\n\t\t\t\t\ttype: 'map',\r\n\t\t\t\t\tmapType: 'china',\r\n\t\t\t\t\tselectedMode : 'multiple',\r\n\t\t\t\t\tlabel: {\r\n\t\t\t\t\t\tnormal: {\r\n\t\t\t\t\t\t\tshow: true,\r\n\t\t\t\t\t\t\ttextStyle: {\r\n\t\t\t\t\t\t\t\tcolor: ctrl.panel.labelColor\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\temphasis: {\r\n\t\t\t\t\t\t\tshow: true,\r\n\t\t\t\t\t\t\ttextStyle: {\r\n\t\t\t\t\t\t\t\tcolor: ctrl.panel.labelEmphasisColor\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\titemStyle: {\r\n\t\t\t\t\t\tnormal: {\r\n\t\t\t\t\t\t\tareaColor: ctrl.panel.itemNormalColor,\r\n\t\t\t\t\t\t\tborderColor: ctrl.panel.itemBorderColor\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\temphasis: {\r\n\t\t\t\t\t\t\tareaColor: ctrl.panel.itemEmphasisColor\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\t\t\r\n\t\t\t\t\tdata:[\r\n\t\t\t\t\t\t{name:'广东', value: value1},\r\n\t\t\t\t\t\t{name:'江苏', value: value2},\r\n\t\t\t\t\t]\r\n\t\t\t\t}\r\n\t\t\t]\r\n\t\t};\r\n    // 使用刚指定的配置项和数据显示图表。\r\n    ctrl.map.setOption(option);\r\n\t\r\n\tconsole.log('crtl.height is' + ctrl.height)\r\n    ctrl.map.resize('auto',ctrl.height);\r\n\t\t\r\n\r\n\t/*\r\n    if (ctrl.mapCenterMoved) ctrl.map.panToMapCenter();\r\n\r\n    if (!ctrl.map.legend && ctrl.panel.showLegend) ctrl.map.createLegend();\r\n\r\n    ctrl.map.drawCircles();\r\n\t*/\r\n\t\r\n  }\r\n}"]}